<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.webank.webase.node.mgr.alert.mail.server.config.MailServerConfigMapper">
    <resultMap id="mailServerConfigMap"
               type="com.webank.webase.node.mgr.alert.mail.server.config.entity.TbMailServerConfig">
        <id column="server_id" javaType="java.lang.Integer" jdbcType="INTEGER"
            property="serverId" />
        <result column="server_name" javaType="java.lang.String" jdbcType="VARCHAR"
                property="serverName" />
        <result column="host" javaType="java.lang.String" jdbcType="VARCHAR"
                property="host" />
        <result column="port" javaType="java.lang.String" jdbcType="VARCHAR"
                property="port" />
        <result column="username" javaType="java.lang.String" jdbcType="VARCHAR"
                property="username" />
        <result column="password" javaType="java.lang.String" jdbcType="VARCHAR"
                property="password" />
        <result column="protocol" javaType="java.lang.String" jdbcType="VARCHAR"
                property="protocol" />
        <result column="default_encoding" javaType="java.lang.String" jdbcType="VARCHAR"
                property="defaultEncoding" />
        <result column="create_time" javaType="java.time.LocalDateTime" jdbcType="TIMESTAMP"
                property="createTime" />
        <result column="modify_time" javaType="java.time.LocalDateTime" jdbcType="TIMESTAMP"
                property="modifyTime" />
    </resultMap>


    <insert id="add" parameterType="com.webank.webase.node.mgr.alert.mail.server.config.entity.TbMailServerConfig">
        REPLACE INTO tb_mail_server_config(server_id,server_name,host,port,username,password,
        protocol,default_encoding,create_time,modify_time)
        VALUES (#{serverId},#{serverName},#{host},#{port},#{username},#{password},
        #{protocol},#{defaultEncoding}, now(), now())
    </insert>

    <delete id="deleteByServerId" parameterType="java.lang.Integer">
        delete from tb_mail_server_config
        where server_id = #{serverId}
    </delete>

    <update id="update" parameterType="com.webank.webase.node.mgr.alert.mail.server.config.entity.TbMailServerConfig">
        update tb_mail_server_config set modify_time = now()
        <if test="serverName != null and serverName != ''">
            ,server_name = #{serverName}
        </if>
        <if test="host != null and host != ''">
            ,host = #{host}
        </if>
        <if test="port != null and port != ''">
            ,port = #{port}
        </if>
        <if test="username != null and username != ''">
            ,username = #{username}
        </if>
        <if test="password != null and password != ''">
            ,password = #{password}
        </if>
        <if test="protocol != null and protocol != ''">
            ,protocol = #{protocol}
        </if>
        <if test="defaultEncoding != null and defaultEncoding != ''">
            ,default_encoding = #{defaultEncoding}
        </if>
        where server_id = #{serverId}
    </update>

    <select id="listOfMailServerConfig" resultMap="mailServerConfigMap">
        select * from tb_mail_server_config a where 1=1
        <!--        <if test="fingerPrint != null and fingerPrint != ''">-->
        <!--            and a.finger_print = #{fingerPrint}-->
        <!--        </if>-->
    </select>

    <select id="queryByServerId" parameterType="java.lang.Integer"
            resultMap="mailServerConfigMap">
        SELECT a.* FROM tb_mail_server_config a
        WHERE server_id = #{serverId}
        limit 1
    </select>

</mapper>